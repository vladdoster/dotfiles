#!/usr/bin/env zsh
#
# Remove all Docker related resources

if docker container ls 2> /dev/null; then
  builtin print -P "${ZINIT[col-error]}ERROR:%f%b Couldn't find ${ZINIT[col-obj]}$(docker container ls --all --quiet | wc -l)%f%b."
  docker container kill $(docker container ls --quiet)
  docker container stop $(docker container ls --all --quiet)
  +zinit-message "--- {msg2}found {cmd}$(docker container ls --all --quiet | wc -l){msg2} running containers{rst}"
  +zinit-message "--- {msg2} pruning docker resources{rst}"
  docker system prune --all --force
  +zinit-message "--- {msg2} pruning docker volumes{rst}"
  docker volume prune --force
  exit 0
else
  builtin print -P "${ZINIT[col-error]}ERROR:%f%b Couldn't find ${ZINIT[col-obj]}docker daemon%f%b."
  exit 1
fi
